{% load static %}

<!DOCTYPE html>
<html>
<head>
    {% load bootstrap5 %}
    {% bootstrap_css %}
    {% bootstrap_javascript %}
    {% bootstrap_messages %}
    <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
    <script src="https://code.jquery.com/ui/1.13.2/jquery-ui.js"
      integrity="sha256-xLD7nhI62fcsEZK2/v8LsBcb4lG7dgULkuXoXB/j91c=" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="{% static "css/jquery.fias.min.css" %}" />
    <script src="{% static "scripts/jquery.fias.min.js" %}"></script>
    <title>Weather</title>
</head>
<body>
    <form action="{% url 'index' %}" method="POST" class="form" id="main_form">
        {% csrf_token %}
        <div class="container-md">
            <div class="input-group  min-vh-100 d-flex justify-content-center align-items-center">
                {{main_form.city}}
                <div class="input-group-append">
                    <button class="btn btn-outline-primary" id="get_weather" type="submit">Прогноз</button>
                </div>
            </div>
        </div>
    </form>
</body>
<div id="forecast">
</div>
</html>

<script>
    $('document').ready(function () {
        $('#city').fias({
           type: 'city',
        });
        var frm = $('#main_form');
        console.log(frm);
        frm.submit(function () {
        $.ajax({
            type: frm.attr('method'),
            url: frm.attr('action'),
            data: frm.serialize(),
            success: function (data) {
                console.log(data);
                $("#forecast").html(data);
            }
        }).done(function () {
            $('#forecast-modal').modal('show');
        });
        return false;
    });
    })
</script>